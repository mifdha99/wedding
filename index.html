<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MIE TIP TOP - Full Upgrade</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:"Poppins",sans-serif;
  background: linear-gradient(160deg,#f9d71c 80%,#e74c3c 10%,#2ecc71 10%);
  color:#333;overflow-x:hidden;transition:background 1s ease;
}
header{
  background:rgba(255,255,255,0.95);
  text-align:center;
  padding:25px 15px;
  box-shadow:0 4px 10px rgba(0,0,0,0.15);
  position:sticky;top:0;z-index:10;
  animation:fadeInDown 0.6s ease;
}
header img{
  width:100px;border-radius:50%;
  box-shadow:0 2px 8px rgba(0,0,0,0.3);
  margin-bottom:10px;background:white;padding:5px;
  transition:transform 0.3s ease;
}
header img:hover{transform:rotate(10deg) scale(1.1);}
h1{color:#e74c3c;font-size:2em;margin:0;}
p{color:#2c3e50;margin:5px 0 15px;}
.menu{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
  gap:20px;
  padding:20px;
  animation:fadeInUp 0.6s ease;
}
.item{
  background:white;border-radius:20px;padding:15px;text-align:center;
  box-shadow:0 3px 8px rgba(0,0,0,0.15);
  transition:transform 0.3s ease,box-shadow 0.3s ease;
  opacity:0;transform:translateY(20px);
  animation:appear 0.8s forwards;
}
.item:hover{
  transform:scale(1.05);
  box-shadow:0 6px 15px rgba(0,0,0,0.2);
}
.item h3{color:#e67e22;margin:10px 0;}
.item p{color:#555;margin-bottom:10px;}
button{
  background:#27ae60;border:none;padding:10px 15px;color:white;border-radius:10px;
  cursor:pointer;font-weight:bold;transition:all 0.3s ease;
}
button:hover{background:#1e8449;}
.cart{
  margin:20px;background:#fff;border-radius:20px;padding:20px;
  box-shadow:0 3px 8px rgba(0,0,0,0.15);
  animation:fadeInUp 0.6s ease;
}
.cart h2{color:#e74c3c;text-align:center;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
th,td{border-bottom:1px solid #ddd;padding:10px;text-align:center;}
.total{font-size:18px;text-align:right;font-weight:bold;color:#e67e22;}
.order-btn{
  background:#f39c12;padding:12px 20px;border-radius:10px;border:none;
  display:block;margin:15px auto;font-size:16px;color:white;cursor:pointer;font-weight:bold;
  transition:all 0.3s ease;
}
.order-btn:hover{background:#d35400;}
/* Popup Konfirmasi */
.popup{
  position:fixed;top:0;left:0;right:0;bottom:0;
  display:none;justify-content:center;align-items:center;
  background:rgba(0,0,0,0.6);z-index:1000;animation:fadeIn 0.4s ease;
}
.popup-content{
  background:white;padding:25px;border-radius:15px;text-align:center;
  box-shadow:0 4px 12px rgba(0,0,0,0.2);max-width:300px;width:80%;
  animation:popUp 0.4s ease;
}
.popup-content input{
  margin-top:10px;padding:8px;width:90%;border:1px solid #ccc;border-radius:8px;
}
.popup-buttons{
  margin-top:15px;display:flex;justify-content:space-around;
}
.popup-buttons button:first-child{background:#2ecc71;}
.popup-buttons button:last-child{background:#e74c3c;}
/* Loading Page */
.loading-page{
  display:none;height:100vh;width:100%;
  background:linear-gradient(160deg,#f9d71c 80%,#e74c3c 10%,#2ecc71 10%);
  position:fixed;top:0;left:0;justify-content:center;align-items:center;
  flex-direction:column;z-index:999;animation:fadeIn 0.5s ease;
}
.spinner{
  width:80px;height:80px;border:8px solid #fff;border-top:8px solid #e67e22;border-radius:50%;
  animation:spin 1s linear infinite;
}
.loading-text{
  margin-top:25px;font-size:22px;color:#e74c3c;font-weight:bold;text-shadow:1px 1px 2px #fff;
}
.reload-btn{
  margin-top:30px;background:#27ae60;padding:12px 20px;border-radius:10px;border:none;
  color:#fff;font-weight:bold;cursor:pointer;display:none;
}
.reload-btn:hover{background:#1e8449;}
.toast{
  position:fixed;bottom:30px;left:50%;transform:translateX(-50%);
  background:rgba(0,0,0,0.8);color:white;padding:12px 25px;border-radius:25px;
  font-weight:bold;opacity:0;pointer-events:none;transition:opacity 0.5s ease;
  z-index:2000;
}
/* Animations */
@keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
@keyframes fadeInUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
@keyframes fadeInDown{from{opacity:0;transform:translateY(-20px);}to{opacity:1;transform:translateY(0);}}
@keyframes appear{to{opacity:1;transform:translateY(0);}}
@keyframes popUp{from{transform:scale(0.8);opacity:0;}to{transform:scale(1);opacity:1;}}
@keyframes spin{to{transform:rotate(360deg);}}
@keyframes jump{0%{transform:translateY(0);}50%{transform:translateY(-15px);}100%{transform:translateY(0);}}
</style>
</head>
<body>
<header id="mainHeader">
  <img src="https://cdn-icons-png.flaticon.com/512/1046/1046784.png" alt="Mangkuk Mie Ayam" />
  <h1>üçú MIE TIP TOP</h1>
  <p>Lezat, Cepat, dan Bikin Nagih!</p>
</header>

<section class="menu" id="menuSection">
  <div class="item" style="animation-delay:0.1s"><h3>Mie Ayam Original</h3><p>Rp 15.000</p><button onclick="addToCart('Mie Ayam Original',15000)">Tambah</button></div>
  <div class="item" style="animation-delay:0.2s"><h3>Mie Ayam Bakso</h3><p>Rp 18.000</p><button onclick="addToCart('Mie Ayam Bakso',18000)">Tambah</button></div>
  <div class="item" style="animation-delay:0.3s"><h3>Mie Ayam Pangsit</h3><p>Rp 20.000</p><button onclick="addToCart('Mie Ayam Pangsit',20000)">Tambah</button></div>
  <div class="item" style="animation-delay:0.4s"><h3>Mie Ayam Spesial Komplit</h3><p>Rp 25.000</p><button onclick="addToCart('Mie Ayam Spesial Komplit',25000)">Tambah</button></div>
</section>

<section class="cart" id="cartSection">
  <h2>üßæ Pesanan Kamu</h2>
  <table id="cartTable">
    <thead><tr><th>Menu</th><th>Jumlah</th><th>Harga</th><th>Total</th></tr></thead>
    <tbody></tbody>
  </table>
  <p class="total">Total: Rp <span id="totalPrice">0</span></p>
  <button class="order-btn" onclick="confirmOrder()">üõí Pesan Sekarang</button>
</section>

<!-- Popup Konfirmasi -->
<div class="popup" id="confirmPopup">
  <div class="popup-content">
    <h3>Konfirmasi Pesanan</h3>
    <p>Masukkan nama pelanggan:</p>
    <input type="text" id="customerName" placeholder="Nama Kamu" />
    <div class="popup-buttons">
      <button onclick="startOrder()">Ya, Pesan!</button>
      <button onclick="closePopup()">Batal</button>
    </div>
  </div>
</div>

<!-- Loading Page -->
<div class="loading-page" id="loadingPage">
  <div class="spinner"></div>
  <div class="loading-text" id="loadingText">Pesanan sedang dibuat... üçú</div>
  <button class="reload-btn" id="reloadBtn" onclick="reloadPage()">Pesan Lagi</button>
  <audio id="frySound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_2b99a6b3b7.mp3?filename=frying-pan-1-7065.mp3"></audio>
  <audio id="clickSound" src="https://freesound.org/data/previews/320/320655_5260872-lq.mp3"></audio>
  <audio id="coinSound" src="https://freesound.org/data/previews/341/341695_62473-lq.mp3"></audio>
</div>

<div class="toast" id="toast"></div>

<script>
let cart = JSON.parse(localStorage.getItem("cartData")) || [];
let historyData = JSON.parse(localStorage.getItem("historyData")) || [];

function showToast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg;t.style.opacity="1";
  setTimeout(()=>{t.style.opacity="0";},1500);
}

function playSound(id){document.getElementById(id).currentTime=0;document.getElementById(id).play();}

function addToCart(name, price){
  playSound("clickSound");
  const existing=cart.find(i=>i.name===name);
  if(existing) existing.qty++; else cart.push({name,price,qty:1});
  renderCart();
  localStorage.setItem("cartData",JSON.stringify(cart));
  animateButton(name);
  showToast(`${name} ditambahkan ke keranjang!`);
}

function animateButton(name){
  const btns=document.querySelectorAll(".item button");
  btns.forEach(btn=>{
    if(btn.textContent.includes("Tambah") && btn.parentElement.querySelector("h3").textContent===name){
      btn.style.animation="jump 0.4s"; setTimeout(()=>{btn.style.animation="";},400);
    }
  });
}

function renderCart(){
  const tbody=document.querySelector("#cartTable tbody");tbody.innerHTML="";
  let total=0;
  cart.forEach(item=>{
    const sub=item.price*item.qty;
    tbody.innerHTML+=`<tr><td>${item.name}</td><td>${item.qty}</td><td>Rp ${item.price.toLocaleString()}</td><td>Rp ${sub.toLocaleString()}</td></tr>`;
    total+=sub;
  });
  // Diskon 5% jika total >50000
  if(total>50000){total=Math.floor(total*0.95);}
  document.getElementById("totalPrice").textContent=total.toLocaleString();
}

function confirmOrder(){
  if(cart.length===0) return alert("Belum ada pesanan!");
  document.getElementById("confirmPopup").style.display="flex";
}

function closePopup(){document.getElementById("confirmPopup").style.display="none";}

function startOrder(){
  const name=document.getElementById("customerName").value.trim();
  if(!name) return alert("Nama belum diisi!");
  localStorage.removeItem("cartData");
  historyData.push({name,cart,time:new Date().toLocaleString()});
  localStorage.setItem("historyData",JSON.stringify(historyData));
  document.getElementById("confirmPopup").style.display="none";
  goToLoading(name);
}

function goToLoading(name){
  document.getElementById("mainHeader").style.display="none";
  document.getElementById("menuSection").style.display="none";
  document.getElementById("cartSection").style.display="none";
  document.getElementById("loadingPage").style.display="flex";
  playSound("frySound");
  const totalTime=cart.reduce((a,b)=>a+b.qty,0)*1000+2000;
  setTimeout(()=>{document.getElementById("loadingText").textContent=`Pesanan atas nama ${name} hampir siap... üî•`;},2500);
  setTimeout(()=>{
    document.getElementById("frySound").pause();
    document.getElementById("frySound").currentTime=0;
    document.getElementById("loadingText").textContent=`Pesanan ${name} Selesai! üçΩÔ∏è`;
    document.getElementById("reloadBtn").style.display="inline-block";
    playSound("coinSound");
  },totalTime);
}

function reloadPage(){location.reload();}

renderCart();
</script>
</body>
</html>
